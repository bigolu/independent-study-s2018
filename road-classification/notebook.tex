
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{road\_classification}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{road-classification}{%
\section{Road Classification}\label{road-classification}}

    Another project that we faced was classifying the roads of Shenzhen
given training data in the form of CSV files. The data we were given was
private vehicle trips and truck trips with the following facets:
coordinates of the trip and timestamps of the trip. From this data we
could formulize feature vectors that contained the following data about
a particular road: median speed, average speed, 1/4 speed, 3/4 speed,
whether there has been a truck/private vehicle on the road, ratio of
trucks to private vehicles.

    \hypertarget{tools}{%
\subsection{Tools}\label{tools}}

The tools that we chose to accomplish this goal are as follows: - From
the Python stlib we used - csv - to read the data - statistics - for
handy stat functions like mean, median, etc\ldots{}. - IntEnum - We
defined each row of our data in an int enum to make data access as
readable as possible - Third party - sklean - for machine learning
algorithms - numpy - for easy data formatting i.e.~ensuring contiguous
arrays - dateutil - to reliably parse dates

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+sd}{An SVC for road types.}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{k+kn}{import} \PY{n+nn}{csv}
        \PY{k+kn}{import} \PY{n+nn}{collections}
        \PY{k+kn}{import} \PY{n+nn}{statistics}
        \PY{k+kn}{from} \PY{n+nn}{enum} \PY{k}{import} \PY{n}{IntEnum}
        \PY{k+kn}{import} \PY{n+nn}{math}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{svm}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{from} \PY{n+nn}{dateutil} \PY{k}{import} \PY{n}{parser}
        \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\end{Verbatim}


    \hypertarget{enum}{%
\subsection{Enum}\label{enum}}

What we learned from our previous work is that when reading code that
access rows of data stored in lists, it can be very hard to follow if we
simply use int indices. For this reason, we created an IntEnum to make
our data accessing more readable as data{[}Column.DATE{]} probably gives
more information than data{[}0{]}.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{class} \PY{n+nc}{Column}\PY{p}{(}\PY{n}{IntEnum}\PY{p}{)}\PY{p}{:}
            \PY{n}{DATE} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{n}{TRIP\PYZus{}CHAR} \PY{o}{=} \PY{l+m+mi}{1}
            \PY{n}{ROAD\PYZus{}ID} \PY{o}{=} \PY{l+m+mi}{2}
            \PY{n}{LON} \PY{o}{=} \PY{l+m+mi}{3}
            \PY{n}{LAT} \PY{o}{=} \PY{l+m+mi}{4}
            \PY{n}{VEHICLE\PYZus{}TYPE} \PY{o}{=} \PY{l+m+mi}{5}
            \PY{n}{LABEL} \PY{o}{=} \PY{l+m+mi}{6}
\end{Verbatim}


    \hypertarget{global-variables}{%
\subsection{Global Variables}\label{global-variables}}

\begin{itemize}
\tightlist
\item
  CACHE\_SIZE - this is the amount of memory that our SVM can use to
  process our data. We initially set this to 1000, but when we increased
  it, we found it was much faster, which makes sense.
\item
  label\_names - this is a list of the names of each label, or street
  name. Since we mapped our labels to ints, this would allow us to
  access the actual name if we needed it.
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{CACHE\PYZus{}SIZE} \PY{o}{=} \PY{l+m+mi}{4000}
        \PY{n}{label\PYZus{}names} \PY{o}{=} \PY{k+kc}{None}
\end{Verbatim}


    This method was for getting the distance between to points in miles. We
coul not find a library with an implementation of this so we opted to
use this found on someones blog.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} distance between two points in miles}
        \PY{c+c1}{\PYZsh{} see: https://www.johndcook.com/blog/python\PYZus{}longitude\PYZus{}latitude/}
        \PY{k}{def} \PY{n+nf}{distance\PYZus{}on\PYZus{}unit\PYZus{}sphere}\PY{p}{(}\PY{n}{lat1}\PY{p}{,} \PY{n}{long1}\PY{p}{,} \PY{n}{lat2}\PY{p}{,} \PY{n}{long2}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Convert latitude and longitude to}
            \PY{c+c1}{\PYZsh{} spherical coordinates in radians.}
            \PY{n}{degrees\PYZus{}to\PYZus{}radians} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mf}{180.0}
        
            \PY{c+c1}{\PYZsh{} phi = 90 \PYZhy{} latitude}
            \PY{n}{phi1} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{90.0} \PY{o}{\PYZhy{}} \PY{n}{lat1}\PY{p}{)}\PY{o}{*}\PY{n}{degrees\PYZus{}to\PYZus{}radians}
            \PY{n}{phi2} \PY{o}{=} \PY{p}{(}\PY{l+m+mf}{90.0} \PY{o}{\PYZhy{}} \PY{n}{lat2}\PY{p}{)}\PY{o}{*}\PY{n}{degrees\PYZus{}to\PYZus{}radians}
        
            \PY{c+c1}{\PYZsh{} theta = longitude}
            \PY{n}{theta1} \PY{o}{=} \PY{n}{long1}\PY{o}{*}\PY{n}{degrees\PYZus{}to\PYZus{}radians}
            \PY{n}{theta2} \PY{o}{=} \PY{n}{long2}\PY{o}{*}\PY{n}{degrees\PYZus{}to\PYZus{}radians}
        
            \PY{c+c1}{\PYZsh{} Compute spherical distance from spherical coordinates.}
        
            \PY{c+c1}{\PYZsh{} For two locations in spherical coordinates}
            \PY{c+c1}{\PYZsh{} (1, theta, phi) and (1, theta\PYZsq{}, phi\PYZsq{})}
            \PY{c+c1}{\PYZsh{} cosine( arc length ) =}
            \PY{c+c1}{\PYZsh{} sin phi sin phi\PYZsq{} cos(theta\PYZhy{}theta\PYZsq{}) + cos phi cos phi\PYZsq{}}
            \PY{c+c1}{\PYZsh{} distance = rho * arc length}
        
            \PY{n}{cos} \PY{o}{=} \PY{p}{(}\PY{n}{math}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{phi1}\PY{p}{)}\PY{o}{*}\PY{n}{math}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{phi2}\PY{p}{)}\PY{o}{*}\PY{n}{math}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{theta1} \PY{o}{\PYZhy{}} \PY{n}{theta2}\PY{p}{)}
                   \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{phi1}\PY{p}{)}\PY{o}{*}\PY{n}{math}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{phi2}\PY{p}{)}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} sometimes cos \PYZgt{} 1?}
            \PY{k}{if} \PY{n}{cos} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} ¯\PYZbs{}\PYZus{}(ツ)\PYZus{}/¯}
                \PY{n}{cos} \PY{o}{=} \PY{l+m+mi}{1}
        
            \PY{n}{arc} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{acos}\PY{p}{(}\PY{n}{cos}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} Remember to multiply arc by the radius of the earth}
            \PY{c+c1}{\PYZsh{} in your favorite set of units to get length.}
            \PY{k}{return} \PY{n}{arc} \PY{o}{*} \PY{l+m+mi}{3960}
\end{Verbatim}


    This function is for reading our input data from csv(s) into a list. We
ran into many complications while doing so because of assumptions we
made about the data. For example, We assumed that the data would begin
with the start of a trip, but we found that it actually started in the
middle of trip so we omitted that trip. We also found multiple `s' and
`e' chars together which did not make sense, so we removed the extras.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}data}\PY{p}{(}\PY{n}{limit}\PY{p}{)}\PY{p}{:}
            \PY{n}{fnames} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../data/pv/all.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../data/truck/all.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
            \PY{k}{for} \PY{n}{fname} \PY{o+ow}{in} \PY{n}{fnames}\PY{p}{:}
                \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{fname}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
                    \PY{n}{vehicle\PYZus{}type} \PY{o}{=} \PY{n}{fname}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
                    \PY{n}{seen\PYZus{}s} \PY{o}{=} \PY{k+kc}{False}
                    \PY{n}{prev} \PY{o}{=} \PY{k+kc}{None}
        
                    \PY{n}{reader} \PY{o}{=} \PY{n}{tqdm}\PY{p}{(}\PY{n}{csv}\PY{o}{.}\PY{n}{reader}\PY{p}{(}\PY{n}{f}\PY{p}{,} \PY{n}{delimiter}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{,}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
                    \PY{k}{for} \PY{n}{count}\PY{p}{,} \PY{n}{datum} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{reader}\PY{p}{)}\PY{p}{:}
                        \PY{k}{if} \PY{n}{count} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{limit}\PY{p}{:}
                            \PY{k}{break}
        
                        \PY{n}{reader}\PY{o}{.}\PY{n}{set\PYZus{}description\PYZus{}str}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Processing row }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{/}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ in }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
                                                   \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{count}\PY{p}{,} \PY{n}{limit}\PY{p}{,} \PY{n}{fname}\PY{p}{)}\PY{p}{)}
        
                        \PY{n}{datum} \PY{o}{=} \PY{p}{[}\PY{n}{parser}\PY{o}{.}\PY{n}{parse}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                 \PY{n+nb}{int}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{float}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{float}\PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{vehicle\PYZus{}type}\PY{p}{,} \PY{n}{datum}\PY{p}{[}\PY{l+m+mi}{15}\PY{p}{]}\PY{p}{]}
        
                        \PY{c+c1}{\PYZsh{} filter out remainder of trip at beginning of data}
                        \PY{c+c1}{\PYZsh{} (data should start with an \PYZsq{}s\PYZsq{})}
                        \PY{k}{if} \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                            \PY{n}{seen\PYZus{}s} \PY{o}{=} \PY{k+kc}{True}
                        \PY{k}{if} \PY{o+ow}{not} \PY{n}{seen\PYZus{}s} \PY{o+ow}{and} \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                            \PY{k}{continue}
        
                        \PY{c+c1}{\PYZsh{} filter out extra \PYZsq{}S\PYZsq{} and \PYZsq{}E\PYZsq{} chars}
                        \PY{n}{is\PYZus{}start\PYZus{}or\PYZus{}end} \PY{o}{=} \PY{p}{(}\PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}
                                           \PY{o+ow}{or} \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{e}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                        \PY{n}{same\PYZus{}char\PYZus{}as\PYZus{}prev} \PY{o}{=} \PY{p}{(}\PY{n}{prev}
                                             \PY{o+ow}{and} \PY{p}{(}\PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]}
                                                  \PY{o}{==} \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                        \PY{k}{if} \PY{n}{is\PYZus{}start\PYZus{}or\PYZus{}end} \PY{o+ow}{and} \PY{n}{same\PYZus{}char\PYZus{}as\PYZus{}prev}\PY{p}{:}
                            \PY{k}{continue}
        
                        \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{datum}\PY{p}{)}
        
                        \PY{n}{prev} \PY{o}{=} \PY{n}{datum}
        
            \PY{c+c1}{\PYZsh{} map labels to ints}
            \PY{k}{global} \PY{n}{label\PYZus{}names}
            \PY{c+c1}{\PYZsh{} get a set of all unique labels then convert to a list}
            \PY{c+c1}{\PYZsh{} so that it is indexable}
            \PY{n}{label\PYZus{}names} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{LABEL}\PY{p}{]} \PY{k}{for} \PY{n}{datum} \PY{o+ow}{in} \PY{n}{data}\PY{p}{]}\PY{p}{)}\PY{p}{)}
            \PY{k}{for} \PY{n}{datum} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
                \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{LABEL}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}names}\PY{o}{.}\PY{n}{index}\PY{p}{(}
                    \PY{n}{datum}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{LABEL}\PY{p}{]}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{data}
\end{Verbatim}


    \begin{verbatim}
This is the function where we process the raw rows of data into feature vectors, one per road. Due to its complexity, we had to split it into two parts.
The first part was creating a dictionary of metadata for each road. This includes the number of trucks and private vehicles on the road, a list of all the speeds traveled on said road, and its classification. From this information, we could be the feature vectors.
Once this was complete, we just had to perform various stat functions on the speeds list and we would have our vectors!
\end{verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}features}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
            \PY{n}{roads} \PY{o}{=} \PY{n}{collections}\PY{o}{.}\PY{n}{defaultdict}\PY{p}{(}
                \PY{k}{lambda}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}truck}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}pv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{speeds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{p}{]}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
        
            \PY{n}{prev} \PY{o}{=} \PY{k+kc}{None}
            \PY{n}{data\PYZus{}tqdm} \PY{o}{=} \PY{n}{tqdm}\PY{p}{(}\PY{n}{data}\PY{p}{)}
            \PY{n}{data\PYZus{}len} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}
            \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{datum} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{data\PYZus{}tqdm}\PY{p}{)}\PY{p}{:}
                \PY{n}{data\PYZus{}tqdm}\PY{o}{.}\PY{n}{set\PYZus{}description\PYZus{}str}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Processing datum }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{/}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
                                              \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{idx}\PY{p}{,} \PY{n}{data\PYZus{}len}\PY{p}{)}\PY{p}{)}
        
                \PY{n}{date}\PY{p}{,} \PY{n}{trip\PYZus{}char}\PY{p}{,} \PY{n}{road\PYZus{}id}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{vehicle\PYZus{}type}\PY{p}{,} \PY{n}{label} \PY{o}{=}\PYZbs{}
                    \PY{n}{datum}
        
                \PY{n}{roads}\PY{p}{[}\PY{n}{road\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label}
        
                \PY{c+c1}{\PYZsh{} add to vehicle count}
                \PY{n}{vehicle\PYZus{}key} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}truck}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n}{vehicle\PYZus{}type} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{truck}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}pv}\PY{l+s+s1}{\PYZsq{}}
                \PY{n}{roads}\PY{p}{[}\PY{n}{road\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{n}{vehicle\PYZus{}key}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        
                \PY{c+c1}{\PYZsh{} add to speeds if not last point}
                \PY{n}{part\PYZus{}of\PYZus{}same\PYZus{}trip} \PY{o}{=} \PY{p}{(}\PY{n}{prev}
                                     \PY{o+ow}{and} \PY{p}{(}\PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}
                                          \PY{o+ow}{or} \PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{TRIP\PYZus{}CHAR}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                                     \PY{o+ow}{and} \PY{p}{(}\PY{n}{trip\PYZus{}char} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{or} \PY{n}{trip\PYZus{}char} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{e}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
                \PY{k}{if} \PY{n}{part\PYZus{}of\PYZus{}same\PYZus{}trip}\PY{p}{:}
                    \PY{n}{time\PYZus{}diff} \PY{o}{=} \PY{n}{date} \PY{o}{\PYZhy{}} \PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{DATE}\PY{p}{]}
                    \PY{n}{hours} \PY{o}{=} \PY{n}{time\PYZus{}diff}\PY{o}{.}\PY{n}{seconds} \PY{o}{/} \PY{l+m+mi}{60} \PY{o}{/} \PY{l+m+mi}{60}
        
                    \PY{n}{prev\PYZus{}lat} \PY{o}{=} \PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{LAT}\PY{p}{]}
                    \PY{n}{prev\PYZus{}lon} \PY{o}{=} \PY{n}{prev}\PY{p}{[}\PY{n}{Column}\PY{o}{.}\PY{n}{LON}\PY{p}{]}
                    \PY{n}{miles} \PY{o}{=} \PY{n}{distance\PYZus{}on\PYZus{}unit\PYZus{}sphere}\PY{p}{(}\PY{n}{lat}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{prev\PYZus{}lat}\PY{p}{,}
                                                    \PY{n}{prev\PYZus{}lon}\PY{p}{)}
        
                    \PY{c+c1}{\PYZsh{} things happen}
                    \PY{k}{if} \PY{n}{miles} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{or} \PY{n}{hours} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                        \PY{k}{continue}
        
                    \PY{n}{speed} \PY{o}{=} \PY{n}{miles} \PY{o}{/} \PY{n}{hours}
                    \PY{n}{roads}\PY{p}{[}\PY{n}{road\PYZus{}id}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{speeds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{speed}\PY{p}{)}
        
                \PY{n}{prev} \PY{o}{=} \PY{n}{datum}
        
            \PY{n}{features} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{n}{roads\PYZus{}len} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{roads}\PY{p}{)}
            \PY{n}{roads\PYZus{}tqdm} \PY{o}{=} \PY{n}{tqdm}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{roads}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
            \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{p}{(}\PY{n}{k}\PY{p}{,} \PY{n}{v}\PY{p}{)} \PY{o+ow}{in} \PY{n}{roads\PYZus{}tqdm}\PY{p}{:}
                \PY{n}{roads\PYZus{}tqdm}\PY{o}{.}\PY{n}{set\PYZus{}description\PYZus{}str}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Creating feature vector }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{/}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
                                               \PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{roads\PYZus{}len}\PY{p}{)}\PY{p}{)}
        
                \PY{n}{num\PYZus{}truck}\PY{p}{,} \PY{n}{num\PYZus{}pv}\PY{p}{,} \PY{n}{speeds}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{p}{(}\PY{n}{v}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}truck}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{v}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}pv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                                    \PY{n}{v}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{speeds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{v}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                \PY{n}{speeds}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
        
                \PY{c+c1}{\PYZsh{} for some reason some roads have no speeds?}
                \PY{k}{if} \PY{o+ow}{not} \PY{n}{speeds}\PY{p}{:}
                    \PY{k}{continue}
        
                \PY{n}{features}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}
                    \PY{c+c1}{\PYZsh{} 1/4 speed}
                    \PY{n}{speeds}\PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{speeds}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} median speed}
                    \PY{n}{statistics}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{speeds}\PY{p}{)}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} 3/4 speed}
                    \PY{n}{speeds}\PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{speeds}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{4}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} average speed}
                    \PY{n}{statistics}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{speeds}\PY{p}{)}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} existance of pv}
                    \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{num\PYZus{}pv} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} existance of truck}
                    \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{num\PYZus{}truck} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} percentage of pv on road}
                    \PY{n}{num\PYZus{}pv} \PY{o}{/} \PY{p}{(}\PY{n}{num\PYZus{}pv} \PY{o}{+} \PY{n}{num\PYZus{}truck}\PY{p}{)}\PY{p}{,}
                    \PY{c+c1}{\PYZsh{} percentage of truck on road}
                    \PY{n}{num\PYZus{}truck} \PY{o}{/} \PY{p}{(}\PY{n}{num\PYZus{}pv} \PY{o}{+} \PY{n}{num\PYZus{}truck}\PY{p}{)}\PY{p}{]}\PY{p}{)}
                \PY{n}{labels}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{label}\PY{p}{)}
        
            \PY{k}{return} \PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}


    This method was for splitting our data into training and testing data.
This was important because if we simply trained on the data and then
tested on it, our score would be extremly biased, or overfitted, because
it was trained on what is is being told to predict. We chose to ues 60\%
for testing and 40\% for training.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}train\PYZus{}test\PYZus{}data}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{p}{[}
                \PY{n}{np}\PY{o}{.}\PY{n}{ascontiguousarray}\PY{p}{(}\PY{n}{arr}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{float32}\PY{p}{)}
                \PY{k}{for} \PY{n}{arr}
                \PY{o+ow}{in} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    Despite being the least amount of code, this method actually takes up
the majority of the runtime. That is because this is the method which
trains the classifier.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}classifier}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fitting model.....}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{clf} \PY{o}{=} \PY{n}{svm}\PY{o}{.}\PY{n}{SVC}\PY{p}{(}\PY{n}{cache\PYZus{}size}\PY{o}{=}\PY{n}{CACHE\PYZus{}SIZE}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fitting model DONE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{clf}
\end{Verbatim}


    This lets us know how well we did. The best score we recieved was 30\%.
Despite how low this is, we are confident that with more training data,
it could actually perform quite well. We only had 40,000 vectors, but I
imagine we would need somthing in the millions.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}score}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Calculating score.....}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{score} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Calculating score DONE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{score}
\end{Verbatim}


    Runs the classifier

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{if} \PY{n+nv+vm}{\PYZus{}\PYZus{}name\PYZus{}\PYZus{}} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}\PYZus{}main\PYZus{}\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{data} \PY{o}{=} \PY{n}{get\PYZus{}data}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{\PYZus{}000\PYZus{}000\PYZus{}000}\PY{p}{)}
            \PY{n}{features}\PY{p}{,} \PY{n}{labels} \PY{o}{=} \PY{n}{get\PYZus{}features}\PY{p}{(}\PY{n}{data}\PY{p}{)}
            \PY{n}{f\PYZus{}train}\PY{p}{,} \PY{n}{f\PYZus{}test}\PY{p}{,} \PY{n}{l\PYZus{}train}\PY{p}{,} \PY{n}{l\PYZus{}test} \PY{o}{=} \PY{n}{get\PYZus{}train\PYZus{}test\PYZus{}data}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
            \PY{n}{clf} \PY{o}{=} \PY{n}{get\PYZus{}classifier}\PY{p}{(}\PY{n}{f\PYZus{}train}\PY{p}{,} \PY{n}{l\PYZus{}train}\PY{p}{)}
            \PY{n}{score} \PY{o}{=} \PY{n}{get\PYZus{}score}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{f\PYZus{}test}\PY{p}{,} \PY{n}{l\PYZus{}test}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SCORE: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{score} \PY{o}{*} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
